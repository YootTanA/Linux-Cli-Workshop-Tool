#!/bin/bash

# Default ENV settings
TARGET_DIR=home/
SEPERATOR=-----------------------------------
SALT=linux

if [ -z "$1" ]; then
  echo "Please provide a number of generating user."
  exit 1
fi

COUNT=$1

for ((i=1; i<=COUNT; i++)); do 
   last_user_number=$(ls $TARGET_DIR | nl | awk -F ' ' 'END {print $1}')
   new_user="user-$((last_user_number + 1))"
   new_user_password=$(echo "SEED" | openssl passwd -1 -stdin)
   
   # Adding new user to the server.
   # ONLY STDERR can be seen in this command.
   sudo useradd -m -p $new_user_password $new_user > /dev/null 2>&1
   
   mkdir ./quest-report/$new_user
   
   # Generate user information
   echo $SEPERATOR >> users
   echo $new_user >> users
   echo $new_user_password >> users
   echo $SEPERATOR >> users
done
